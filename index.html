<html class="scroll-smooth" lang="id">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Toko Plastik Tunas Mustika
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
  <style>
   body {
      font-family: 'Inter', sans-serif;
      background: #f0f9f4;
    }
    /* Scrollbar styling for tables */
    ::-webkit-scrollbar {
      height: 8px;
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #e0f2f1;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb {
      background: #4caf50;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #388e3c;
    }
  </style>
 </head>
 <body class="min-h-screen flex flex-col">
  <header class="bg-gradient-to-r from-green-600 to-green-800 text-white shadow-lg sticky top-0 z-50">
   <div class="container mx-auto px-6 py-4 flex flex-col md:flex-row justify-between items-center gap-4 md:gap-0">
    <div class="flex items-center gap-3">
     <img alt="Logo Toko Plastik Tunas Mustika, a green plastic bag icon" class="rounded-full shadow-lg w-12 h-12" height="80" src="https://storage.googleapis.com/a1aa/image/7c3fccb3-4243-42fa-94af-d712346d1be1.jpg" width="80"/>
     <h1 class="text-3xl font-extrabold tracking-wide drop-shadow-md select-none">
      Toko Plastik
      <span class="text-yellow-300">
       Tunas Mustika
      </span>
     </h1>
    </div>
    <nav class="space-x-4 text-sm md:text-base flex items-center">
     <button class="bg-yellow-400 hover:bg-yellow-300 text-green-900 font-semibold px-5 py-2 rounded-lg shadow-md transition shadow-yellow-400/50 hover:shadow-yellow-300/70 focus:outline-none focus:ring-4 focus:ring-yellow-300" id="btnSignIn" type="button">
      Sign In
     </button>
     <button class="bg-transparent border-2 border-yellow-400 hover:bg-yellow-400 hover:text-green-900 text-yellow-400 font-semibold px-5 py-2 rounded-lg shadow-md transition shadow-yellow-400/50 hover:shadow-yellow-300/70 focus:outline-none focus:ring-4 focus:ring-yellow-300" id="btnSignUp" type="button">
      Sign Up
     </button>
    </nav>
   </div>
  </header>
  <main class="flex-grow container mx-auto px-6 py-8 max-w-7xl">
   <section aria-label="Form Authentication" class="max-w-md mx-auto bg-white rounded-3xl shadow-2xl p-8 ring-1 ring-green-200" id="authSection" role="region">
    <h2 class="text-3xl font-extrabold mb-6 text-center text-green-700" id="authTitle">
     Sign In
    </h2>
    <form class="space-y-6" id="authForm" novalidate="">
     <div>
      <label class="block mb-2 font-semibold text-green-800" for="role">
       Pilih Role
      </label>
      <select aria-required="true" class="w-full border border-green-300 rounded-xl px-4 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition" id="role" name="role" required="">
       <option disabled="" selected="" value="">
        -- Pilih Role --
       </option>
       <option value="admin">
        Admin
       </option>
       <option value="kasir">
        Kasir
       </option>
      </select>
     </div>
     <div>
      <label class="block mb-2 font-semibold text-green-800" for="username">
       Username
      </label>
      <input aria-required="true" autocomplete="username" class="w-full border border-green-300 rounded-xl px-4 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition" id="username" name="username" placeholder="Masukkan username" required="" type="text"/>
     </div>
     <div>
      <label class="block mb-2 font-semibold text-green-800" for="password">
       Password
      </label>
      <input aria-required="true" autocomplete="current-password" class="w-full border border-green-300 rounded-xl px-4 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition" id="password" name="password" placeholder="Masukkan password" required="" type="password"/>
     </div>
     <button aria-label="Submit authentication form" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-300 text-green-900 font-extrabold py-3 rounded-xl shadow-lg hover:from-yellow-300 hover:to-yellow-200 transition focus:outline-none focus:ring-4 focus:ring-yellow-300" type="submit">
      Submit
     </button>
    </form>
    <p class="mt-6 text-center text-green-700 font-semibold select-none">
     Belum punya akun?
     <button aria-label="Toggle to sign up form" class="text-yellow-400 hover:text-yellow-300 underline ml-1 focus:outline-none" id="toggleAuth" type="button">
      Sign Up di sini
     </button>
    </p>
   </section>
   <section aria-label="Dashboard" class="hidden max-w-7xl mx-auto mt-10" id="dashboardSection" role="main">
    <div class="flex flex-col md:flex-row md:space-x-8">
     <aside aria-label="Sidebar menu" class="bg-white rounded-3xl shadow-2xl p-6 w-full md:w-72 sticky top-8 h-fit ring-1 ring-green-200" id="sidebar" role="navigation">
      <h3 class="text-xl font-extrabold mb-6 text-green-700 flex items-center gap-3 select-none">
       <i class="fas fa-tools text-yellow-400 text-2xl">
       </i>
       Menu
      </h3>
      <nav aria-label="Dashboard navigation" class="flex flex-col space-y-4 text-green-800 text-base font-semibold">
       <button class="sidebar-btn flex items-center gap-3 hover:text-yellow-400 transition rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400" data-section="produkSection" type="button">
        <i class="fas fa-box-open text-yellow-400">
        </i>
        Data Produk
       </button>
       <button class="sidebar-btn flex items-center gap-3 hover:text-yellow-400 transition rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400" data-section="transaksiSection" type="button">
        <i class="fas fa-shopping-cart text-yellow-400">
        </i>
        Transaksi Penjualan
       </button>
       <button class="sidebar-btn flex items-center gap-3 hover:text-yellow-400 transition rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400" data-section="stokSection" type="button">
        <i class="fas fa-warehouse text-yellow-400">
        </i>
        Kelola Stok Barang
       </button>
       <button class="sidebar-btn flex items-center gap-3 hover:text-yellow-400 transition rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400" data-section="kasbonSection" type="button">
        <i class="fas fa-file-invoice-dollar text-yellow-400">
        </i>
        Kasbon Pelanggan
       </button>
       <button class="sidebar-btn flex items-center gap-3 hover:text-yellow-400 transition rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400" data-section="pembayaranSection" type="button">
        <i class="fas fa-money-bill-wave text-yellow-400">
        </i>
        Pembayaran
       </button>
       <button class="sidebar-btn flex items-center gap-3 hover:text-yellow-400 transition rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400" data-section="laporanSection" type="button">
        <i class="fas fa-chart-line text-yellow-400">
        </i>
        Laporan Penjualan &amp; Kasbon
       </button>
       <button aria-label="Logout" class="mt-10 w-full bg-red-600 hover:bg-red-500 text-white font-extrabold py-3 rounded-xl shadow-lg transition flex items-center justify-center gap-3 focus:outline-none focus:ring-4 focus:ring-red-400" id="btnLogout" type="button">
        <i class="fas fa-sign-out-alt">
        </i>
        Logout
       </button>
      </nav>
     </aside>
     <div class="flex-grow bg-white rounded-3xl shadow-2xl p-8 min-h-[600px] overflow-auto ring-1 ring-green-200">
      <section aria-label="Data Produk" class="dashboard-section" id="produkSection" tabindex="0">
       <h2 class="text-3xl font-extrabold mb-6 text-green-700 flex items-center gap-4 select-none">
        <i class="fas fa-box-open text-yellow-400 text-3xl">
        </i>
        Data Produk
       </h2>
       <form aria-label="Form tambah atau update produk" class="mb-8 grid grid-cols-1 md:grid-cols-4 gap-6" id="produkForm">
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="produkNama">
          Nama Produk
         </label>
         <input aria-describedby="produkNamaHelp" aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="produkNama" placeholder="Contoh: Kantong Plastik 30x40" required="" type="text"/>
         <p class="text-xs text-green-500 mt-1" id="produkNamaHelp">
          Nama produk harus unik dan jelas.
         </p>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="produkHarga">
          Harga (Rp)
         </label>
         <input aria-describedby="produkHargaHelp" aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="produkHarga" min="0" placeholder="Contoh: 5000" required="" type="number"/>
         <p class="text-xs text-green-500 mt-1" id="produkHargaHelp">
          Harga dalam Rupiah, tanpa tanda baca.
         </p>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="produkStok">
          Stok
         </label>
         <input aria-describedby="produkStokHelp" aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="produkStok" min="0" placeholder="Contoh: 100" required="" type="number"/>
         <p class="text-xs text-green-500 mt-1" id="produkStokHelp">
          Jumlah stok tersedia saat ini.
         </p>
        </div>
        <div class="flex items-end justify-center">
         <button aria-label="Tambah atau update produk" class="bg-gradient-to-r from-yellow-400 to-yellow-300 text-green-900 font-extrabold px-8 py-3 rounded-2xl shadow-lg hover:from-yellow-300 hover:to-yellow-200 transition focus:outline-none focus:ring-4 focus:ring-yellow-300" type="submit">
          Tambah / Update Produk
         </button>
        </div>
       </form>
       <div class="overflow-x-auto rounded-xl shadow-inner ring-1 ring-green-200">
        <table class="w-full text-left border-collapse border border-green-300 min-w-[600px]">
         <thead class="bg-green-100 sticky top-0 z-10">
          <tr>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
            #
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
            Nama Produk
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Harga (Rp)
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 100px;">
            Stok
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 120px;">
            Aksi
           </th>
          </tr>
         </thead>
         <tbody class="divide-y divide-green-200" id="produkTableBody" role="rowgroup">
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">1</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 30x40</td>
           <td class="border border-green-300 px-4 py-2">5.000</td>
           <td class="border border-green-300 px-4 py-2">150</td>
           <td class="border border-green-300 px-4 py-2 text-center">
            <button data-id="1" class="produk-edit-btn text-yellow-500 hover:text-yellow-600 mr-3" title="Edit Produk" aria-label="Edit produk Kantong Plastik 30x40">
             <i class="fas fa-edit"></i>
            </button>
            <button data-id="1" class="produk-delete-btn text-red-600 hover:text-red-700" title="Hapus Produk" aria-label="Hapus produk Kantong Plastik 30x40">
             <i class="fas fa-trash-alt"></i>
            </button>
           </td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">2</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 40x50</td>
           <td class="border border-green-300 px-4 py-2">7.000</td>
           <td class="border border-green-300 px-4 py-2">120</td>
           <td class="border border-green-300 px-4 py-2 text-center">
            <button data-id="2" class="produk-edit-btn text-yellow-500 hover:text-yellow-600 mr-3" title="Edit Produk" aria-label="Edit produk Kantong Plastik 40x50">
             <i class="fas fa-edit"></i>
            </button>
            <button data-id="2" class="produk-delete-btn text-red-600 hover:text-red-700" title="Hapus Produk" aria-label="Hapus produk Kantong Plastik 40x50">
             <i class="fas fa-trash-alt"></i>
            </button>
           </td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">3</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 50x60</td>
           <td class="border border-green-300 px-4 py-2">9.000</td>
           <td class="border border-green-300 px-4 py-2">100</td>
           <td class="border border-green-300 px-4 py-2 text-center">
            <button data-id="3" class="produk-edit-btn text-yellow-500 hover:text-yellow-600 mr-3" title="Edit Produk" aria-label="Edit produk Kantong Plastik 50x60">
             <i class="fas fa-edit"></i>
            </button>
            <button data-id="3" class="produk-delete-btn text-red-600 hover:text-red-700" title="Hapus Produk" aria-label="Hapus produk Kantong Plastik 50x60">
             <i class="fas fa-trash-alt"></i>
            </button>
           </td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">4</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 60x80</td>
           <td class="border border-green-300 px-4 py-2">12.000</td>
           <td class="border border-green-300 px-4 py-2">80</td>
           <td class="border border-green-300 px-4 py-2 text-center">
            <button data-id="4" class="produk-edit-btn text-yellow-500 hover:text-yellow-600 mr-3" title="Edit Produk" aria-label="Edit produk Kantong Plastik 60x80">
             <i class="fas fa-edit"></i>
            </button>
            <button data-id="4" class="produk-delete-btn text-red-600 hover:text-red-700" title="Hapus Produk" aria-label="Hapus produk Kantong Plastik 60x80">
             <i class="fas fa-trash-alt"></i>
            </button>
           </td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">5</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 80x100</td>
           <td class="border border-green-300 px-4 py-2">15.000</td>
           <td class="border border-green-300 px-4 py-2">60</td>
           <td class="border border-green-300 px-4 py-2 text-center">
            <button data-id="5" class="produk-edit-btn text-yellow-500 hover:text-yellow-600 mr-3" title="Edit Produk" aria-label="Edit produk Kantong Plastik 80x100">
             <i class="fas fa-edit"></i>
            </button>
            <button data-id="5" class="produk-delete-btn text-red-600 hover:text-red-700" title="Hapus Produk" aria-label="Hapus produk Kantong Plastik 80x100">
             <i class="fas fa-trash-alt"></i>
            </button>
           </td>
          </tr>
         </tbody>
        </table>
       </div>
      </section>
      <section aria-label="Transaksi Penjualan" class="dashboard-section hidden" id="transaksiSection" tabindex="0">
       <h2 class="text-3xl font-extrabold mb-6 text-green-700 flex items-center gap-4 select-none">
        <i class="fas fa-shopping-cart text-yellow-400 text-3xl">
        </i>
        Transaksi Penjualan
       </h2>
       <form aria-label="Form tambah transaksi penjualan" class="mb-8 grid grid-cols-1 md:grid-cols-4 gap-6" id="transaksiForm">
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="transaksiProduk">
          Produk
         </label>
         <select aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="transaksiProduk" required="">
          <option disabled="" selected="" value="">
           Pilih Produk
          </option>
          <option value="1">Kantong Plastik 30x40</option>
          <option value="2">Kantong Plastik 40x50</option>
          <option value="3">Kantong Plastik 50x60</option>
          <option value="4">Kantong Plastik 60x80</option>
          <option value="5">Kantong Plastik 80x100</option>
         </select>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="transaksiJumlah">
          Jumlah
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="transaksiJumlah" min="1" placeholder="Contoh: 2" required="" type="number"/>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="transaksiKasir">
          Kasir
         </label>
         <input aria-readonly="true" class="w-full bg-green-100 border border-green-300 rounded-xl px-5 py-3 text-green-900 cursor-not-allowed" id="transaksiKasir" readonly="" type="text"/>
        </div>
        <div class="flex items-end justify-center">
         <button aria-label="Tambah transaksi penjualan" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-300 text-green-900 font-extrabold py-3 rounded-2xl shadow-lg hover:from-yellow-300 hover:to-yellow-200 transition focus:outline-none focus:ring-4 focus:ring-yellow-300" type="submit">
          Tambah Transaksi
         </button>
        </div>
       </form>
       <div class="overflow-x-auto rounded-xl shadow-inner ring-1 ring-green-200">
        <table class="w-full text-left border-collapse border border-green-300 min-w-[700px]">
         <thead class="bg-green-100 sticky top-0 z-10">
          <tr>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
            #
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
            Produk
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 80px;">
            Jumlah
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Harga Satuan (Rp)
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Total (Rp)
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 120px;">
            Kasir
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 180px;">
            Tanggal
           </th>
          </tr>
         </thead>
         <tbody class="divide-y divide-green-200" id="transaksiTableBody" role="rowgroup">
         </tbody>
        </table>
       </div>
      </section>
      <section aria-label="Kelola Stok Barang" class="dashboard-section hidden" id="stokSection" tabindex="0">
       <h2 class="text-3xl font-extrabold mb-6 text-green-700 flex items-center gap-4 select-none">
        <i class="fas fa-warehouse text-yellow-400 text-3xl">
        </i>
        Kelola Stok Barang
       </h2>
       <form aria-label="Form update stok barang" class="mb-8 grid grid-cols-1 md:grid-cols-3 gap-6" id="stokForm">
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="stokProduk">
          Produk
         </label>
         <select aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="stokProduk" required="">
          <option disabled="" selected="" value="">
           Pilih Produk
          </option>
          <option value="1">Kantong Plastik 30x40</option>
          <option value="2">Kantong Plastik 40x50</option>
          <option value="3">Kantong Plastik 50x60</option>
          <option value="4">Kantong Plastik 60x80</option>
          <option value="5">Kantong Plastik 80x100</option>
         </select>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="stokJumlah">
          Jumlah Penambahan / Pengurangan
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="stokJumlah" placeholder="Contoh: 10 (positif/tambah), -5 (negatif/kurang)" required="" type="number"/>
        </div>
        <div class="flex items-end justify-center">
         <button aria-label="Update stok barang" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-300 text-green-900 font-extrabold py-3 rounded-2xl shadow-lg hover:from-yellow-300 hover:to-yellow-200 transition focus:outline-none focus:ring-4 focus:ring-yellow-300" type="submit">
          Update Stok
         </button>
        </div>
       </form>
       <div class="overflow-x-auto rounded-xl shadow-inner ring-1 ring-green-200">
        <table class="w-full text-left border-collapse border border-green-300 min-w-[600px]">
         <thead class="bg-green-100 sticky top-0 z-10">
          <tr>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
            #
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
            Nama Produk
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 120px;">
            Stok Saat Ini
           </th>
          </tr>
         </thead>
         <tbody class="divide-y divide-green-200" id="stokTableBody" role="rowgroup">
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">1</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 30x40</td>
           <td class="border border-green-300 px-4 py-2">150</td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">2</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 40x50</td>
           <td class="border border-green-300 px-4 py-2">120</td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">3</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 50x60</td>
           <td class="border border-green-300 px-4 py-2">100</td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">4</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 60x80</td>
           <td class="border border-green-300 px-4 py-2">80</td>
          </tr>
          <tr class="hover:bg-green-50">
           <td class="border border-green-300 px-4 py-2">5</td>
           <td class="border border-green-300 px-4 py-2">Kantong Plastik 80x100</td>
           <td class="border border-green-300 px-4 py-2">60</td>
          </tr>
         </tbody>
        </table>
       </div>
      </section>
      <section aria-label="Kasbon Pelanggan" class="dashboard-section hidden" id="kasbonSection" tabindex="0">
       <h2 class="text-3xl font-extrabold mb-6 text-green-700 flex items-center gap-4 select-none">
        <i class="fas fa-file-invoice-dollar text-yellow-400 text-3xl">
        </i>
        Kasbon Pelanggan
       </h2>
       <form aria-label="Form tambah kasbon pelanggan" class="mb-8 grid grid-cols-1 md:grid-cols-4 gap-6" id="kasbonForm">
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="kasbonNama">
          Nama Pelanggan
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="kasbonNama" placeholder="Contoh: Budi Santoso" required="" type="text"/>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="kasbonJumlah">
          Jumlah Kasbon (Rp)
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="kasbonJumlah" min="0" placeholder="Contoh: 100000" required="" type="number"/>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="kasbonTanggal">
          Tanggal
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="kasbonTanggal" required="" type="date"/>
        </div>
        <div class="flex items-end justify-center">
         <button aria-label="Tambah kasbon pelanggan" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-300 text-green-900 font-extrabold py-3 rounded-2xl shadow-lg hover:from-yellow-300 hover:to-yellow-200 transition focus:outline-none focus:ring-4 focus:ring-yellow-300" type="submit">
          Tambah Kasbon
         </button>
        </div>
       </form>
       <div class="overflow-x-auto rounded-xl shadow-inner ring-1 ring-green-200">
        <table class="w-full text-left border-collapse border border-green-300 min-w-[700px]">
         <thead class="bg-green-100 sticky top-0 z-10">
          <tr>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
            #
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
            Nama Pelanggan
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Jumlah Kasbon (Rp)
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Tanggal
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 120px;">
            Status
           </th>
          </tr>
         </thead>
         <tbody class="divide-y divide-green-200" id="kasbonTableBody" role="rowgroup">
         </tbody>
        </table>
       </div>
      </section>
      <section aria-label="Pembayaran" class="dashboard-section hidden" id="pembayaranSection" tabindex="0">
       <h2 class="text-3xl font-extrabold mb-6 text-green-700 flex items-center gap-4 select-none">
        <i class="fas fa-money-bill-wave text-yellow-400 text-3xl">
        </i>
        Pembayaran
       </h2>
       <form aria-label="Form tambah pembayaran" class="mb-8 grid grid-cols-1 md:grid-cols-5 gap-6" id="pembayaranForm">
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="pembayaranNama">
          Nama Pelanggan
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="pembayaranNama" placeholder="Contoh: Budi Santoso" required="" type="text"/>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="pembayaranJumlah">
          Jumlah Pembayaran (Rp)
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="pembayaranJumlah" min="0" placeholder="Contoh: 50000" required="" type="number"/>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="pembayaranMetode">
          Metode Pembayaran
         </label>
         <select aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="pembayaranMetode" required="">
          <option disabled="" selected="" value="">
           Pilih Metode
          </option>
          <option value="tunai">
           Tunai
          </option>
          <option value="transfer">
           Transfer
          </option>
         </select>
        </div>
        <div>
         <label class="block font-semibold mb-2 text-green-800" for="pembayaranTanggal">
          Tanggal
         </label>
         <input aria-required="true" class="w-full border border-green-300 rounded-xl px-5 py-3 text-green-900 placeholder-green-400 focus:outline-none focus:ring-4 focus:ring-green-300 transition shadow-sm" id="pembayaranTanggal" required="" type="date"/>
        </div>
        <div class="flex items-end justify-center">
         <button aria-label="Tambah pembayaran" class="w-full bg-gradient-to-r from-yellow-400 to-yellow-300 text-green-900 font-extrabold py-3 rounded-2xl shadow-lg hover:from-yellow-300 hover:to-yellow-200 transition focus:outline-none focus:ring-4 focus:ring-yellow-300" type="submit">
          Tambah Pembayaran
         </button>
        </div>
       </form>
       <div class="overflow-x-auto rounded-xl shadow-inner ring-1 ring-green-200">
        <table class="w-full text-left border-collapse border border-green-300 min-w-[700px]">
         <thead class="bg-green-100 sticky top-0 z-10">
          <tr>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
            #
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
            Nama Pelanggan
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Jumlah Pembayaran (Rp)
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Metode
           </th>
           <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
            Tanggal
           </th>
          </tr>
         </thead>
         <tbody class="divide-y divide-green-200" id="pembayaranTableBody" role="rowgroup">
         </tbody>
        </table>
       </div>
      </section>
      <section aria-label="Laporan Penjualan dan Kasbon" class="dashboard-section hidden" id="laporanSection" tabindex="0">
       <h2 class="text-3xl font-extrabold mb-6 text-green-700 flex items-center gap-4 select-none">
        <i class="fas fa-chart-line text-yellow-400 text-3xl">
        </i>
        Laporan Penjualan &amp; Kasbon
       </h2>
       <div class="space-y-10">
        <div>
         <h3 class="text-2xl font-extrabold mb-4 text-green-700 select-none">
          Laporan Penjualan
         </h3>
         <div class="overflow-x-auto max-h-72 overflow-y-auto rounded-xl shadow-inner ring-1 ring-green-200">
          <table class="w-full text-left border-collapse border border-green-300 min-w-[600px]">
           <thead class="bg-green-100 sticky top-0 z-10">
            <tr>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
              #
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
              Produk
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
              Jumlah Terjual
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 180px;">
              Total Pendapatan (Rp)
             </th>
            </tr>
           </thead>
           <tbody class="divide-y divide-green-200" id="laporanPenjualanBody" role="rowgroup">
           </tbody>
          </table>
         </div>
        </div>
        <div>
         <h3 class="text-2xl font-extrabold mb-4 text-green-700 select-none">
          Laporan Kasbon
         </h3>
         <div class="overflow-x-auto max-h-72 overflow-y-auto rounded-xl shadow-inner ring-1 ring-green-200">
          <table class="w-full text-left border-collapse border border-green-300 min-w-[700px]">
           <thead class="bg-green-100 sticky top-0 z-10">
            <tr>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 50px;">
              #
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col">
              Nama Pelanggan
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
              Total Kasbon (Rp)
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
              Total Pembayaran (Rp)
             </th>
             <th class="border border-green-300 px-4 py-3 text-green-700 font-semibold select-none" scope="col" style="width: 140px;">
              Sisa Kasbon (Rp)
             </th>
            </tr>
           </thead>
           <tbody class="divide-y divide-green-200" id="laporanKasbonBody" role="rowgroup">
           </tbody>
          </table>
         </div>
        </div>
       </div>
      </section>
     </div>
    </div>
   </section>
  </main>
  <footer class="bg-gradient-to-r from-green-700 to-green-900 text-white text-center py-6 mt-auto select-none shadow-inner">
   <p class="text-sm font-semibold tracking-wide">
    © 2024 Toko Plastik Tunas Mustika. All rights reserved.
   </p>
  </footer>
  <script>
   // Data storage in localStorage keys
    const LS_USERS = "tptm_users";
    const LS_PRODUK = "tptm_produk";
    const LS_TRANSAKSI = "tptm_transaksi";
    const LS_KASBON = "tptm_kasbon";
    const LS_PEMBAYARAN = "tptm_pembayaran";

    // Current logged in user
    let currentUser = null;

    // Elements
    const authSection = document.getElementById("authSection");
    const dashboardSection = document.getElementById("dashboardSection");
    const authTitle = document.getElementById("authTitle");
    const authForm = document.getElementById("authForm");
    const toggleAuthBtn = document.getElementById("toggleAuth");
    const btnSignIn = document.getElementById("btnSignIn");
    const btnSignUp = document.getElementById("btnSignUp");
    const btnLogout = document.getElementById("btnLogout");
    const roleSelect = document.getElementById("role");
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");

    // Dashboard sections and sidebar buttons
    const dashboardSections = document.querySelectorAll(".dashboard-section");
    const sidebarButtons = document.querySelectorAll(".sidebar-btn");

    // Produk elements
    const produkForm = document.getElementById("produkForm");
    const produkNama = document.getElementById("produkNama");
    const produkHarga = document.getElementById("produkHarga");
    const produkStok = document.getElementById("produkStok");
    const produkTableBody = document.getElementById("produkTableBody");

    // Transaksi elements
    const transaksiForm = document.getElementById("transaksiForm");
    const transaksiProduk = document.getElementById("transaksiProduk");
    const transaksiJumlah = document.getElementById("transaksiJumlah");
    const transaksiKasir = document.getElementById("transaksiKasir");
    const transaksiTableBody = document.getElementById("transaksiTableBody");

    // Stok elements
    const stokForm = document.getElementById("stokForm");
    const stokProduk = document.getElementById("stokProduk");
    const stokJumlah = document.getElementById("stokJumlah");
    const stokTableBody = document.getElementById("stokTableBody");

    // Kasbon elements
    const kasbonForm = document.getElementById("kasbonForm");
    const kasbonNama = document.getElementById("kasbonNama");
    const kasbonJumlah = document.getElementById("kasbonJumlah");
    const kasbonTanggal = document.getElementById("kasbonTanggal");
    const kasbonTableBody = document.getElementById("kasbonTableBody");

    // Pembayaran elements
    const pembayaranForm = document.getElementById("pembayaranForm");
    const pembayaranNama = document.getElementById("pembayaranNama");
    const pembayaranJumlah = document.getElementById("pembayaranJumlah");
    const pembayaranMetode = document.getElementById("pembayaranMetode");
    const pembayaranTanggal = document.getElementById("pembayaranTanggal");
    const pembayaranTableBody = document.getElementById("pembayaranTableBody");

    // Laporan elements
    const laporanPenjualanBody = document.getElementById("laporanPenjualanBody");
    const laporanKasbonBody = document.getElementById("laporanKasbonBody");

    // Utility functions
    function saveToLS(key, data) {
      localStorage.setItem(key, JSON.stringify(data));
    }
    function loadFromLS(key) {
      const data = localStorage.getItem(key);
      return data ? JSON.parse(data) : [];
    }

    // Initialize default admin user if none exists
    function initDefaultUsers() {
      let users = loadFromLS(LS_USERS);
      if (users.length === 0) {
        users.push({
          id: 1,
          username: "admin",
          password: "admin123",
          role: "admin",
        });
        users.push({
          id: 2,
          username: "kasir",
          password: "kasir123",
          role: "kasir",
        });
        saveToLS(LS_USERS, users);
      }
    }

    // Initialize default products if none exists
    function initDefaultProduk() {
      let produkList = loadFromLS(LS_PRODUK);
      if (produkList.length === 0) {
        produkList = [
          { id: 1, nama: "Kantong Plastik 30x40", harga: 5000, stok: 150 },
          { id: 2, nama: "Kantong Plastik 40x50", harga: 7000, stok: 120 },
          { id: 3, nama: "Kantong Plastik 50x60", harga: 9000, stok: 100 },
          { id: 4, nama: "Kantong Plastik 60x80", harga: 12000, stok: 80 },
          { id: 5, nama: "Kantong Plastik 80x100", harga: 15000, stok: 60 }
        ];
        saveToLS(LS_PRODUK, produkList);
      }
    }

    // Authentication toggle
    let isSignIn = true;
    function toggleAuth() {
      isSignIn = !isSignIn;
      if (isSignIn) {
        authTitle.textContent = "Sign In";
        toggleAuthBtn.textContent = "Sign Up di sini";
        btnSignIn.classList.remove("hidden");
        btnSignUp.classList.remove("hidden");
      } else {
        authTitle.textContent = "Sign Up";
        toggleAuthBtn.textContent = "Sign In di sini";
        btnSignIn.classList.remove("hidden");
        btnSignUp.classList.remove("hidden");
      }
      authForm.reset();
    }

    // Show dashboard section by id
    function showDashboardSection(id) {
      dashboardSections.forEach((section) => {
        if (section.id === id) {
          section.classList.remove("hidden");
        } else {
          section.classList.add("hidden");
        }
      });
    }

    // Populate produk select options
    function populateProdukSelects() {
      const produkList = loadFromLS(LS_PRODUK);
      // Clear options
      transaksiProduk.innerHTML = '<option value="" disabled selected>Pilih Produk</option>';
      stokProduk.innerHTML = '<option value="" disabled selected>Pilih Produk</option>';
      produkTableBody.innerHTML = "";
      stokTableBody.innerHTML = "";

      produkList.forEach((produk, i) => {
        const option1 = document.createElement("option");
        option1.value = produk.id;
        option1.textContent = produk.nama;
        transaksiProduk.appendChild(option1);

        const option2 = document.createElement("option");
        option2.value = produk.id;
        option2.textContent = produk.nama;
        stokProduk.appendChild(option2);

        // Produk Table Row
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i + 1}</td>
          <td class="border border-green-300 px-4 py-2">${produk.nama}</td>
          <td class="border border-green-300 px-4 py-2">${produk.harga.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${produk.stok}</td>
          <td class="border border-green-300 px-4 py-2 text-center">
            <button data-id="${produk.id}" class="produk-edit-btn text-yellow-500 hover:text-yellow-600 mr-3" title="Edit Produk" aria-label="Edit produk ${produk.nama}">
              <i class="fas fa-edit"></i>
            </button>
            <button data-id="${produk.id}" class="produk-delete-btn text-red-600 hover:text-red-700" title="Hapus Produk" aria-label="Hapus produk ${produk.nama}">
              <i class="fas fa-trash-alt"></i>
            </button>
          </td>
        `;
        produkTableBody.appendChild(tr);

        // Stok Table Row
        const trStok = document.createElement("tr");
        trStok.classList.add("hover:bg-green-50");
        trStok.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i + 1}</td>
          <td class="border border-green-300 px-4 py-2">${produk.nama}</td>
          <td class="border border-green-300 px-4 py-2">${produk.stok}</td>
        `;
        stokTableBody.appendChild(trStok);
      });
    }

    // Populate transaksi table
    function populateTransaksiTable() {
      const transaksiList = loadFromLS(LS_TRANSAKSI);
      const produkList = loadFromLS(LS_PRODUK);
      transaksiTableBody.innerHTML = "";
      transaksiList.forEach((transaksi, i) => {
        const produk = produkList.find((p) => p.id === transaksi.produkId);
        const hargaSatuan = produk ? produk.harga : 0;
        const total = hargaSatuan * transaksi.jumlah;
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i + 1}</td>
          <td class="border border-green-300 px-4 py-2">${produk ? produk.nama : "Produk tidak ditemukan"}</td>
          <td class="border border-green-300 px-4 py-2">${transaksi.jumlah}</td>
          <td class="border border-green-300 px-4 py-2">${hargaSatuan.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${total.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${transaksi.kasir}</td>
          <td class="border border-green-300 px-4 py-2">${new Date(transaksi.tanggal).toLocaleString("id-ID")}</td>
        `;
        transaksiTableBody.appendChild(tr);
      });
    }

    // Populate kasbon table
    function populateKasbonTable() {
      const kasbonList = loadFromLS(LS_KASBON);
      kasbonTableBody.innerHTML = "";
      kasbonList.forEach((kasbon, i) => {
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i + 1}</td>
          <td class="border border-green-300 px-4 py-2">${kasbon.nama}</td>
          <td class="border border-green-300 px-4 py-2">${kasbon.jumlah.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${new Date(kasbon.tanggal).toLocaleDateString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${kasbon.status}</td>
        `;
        kasbonTableBody.appendChild(tr);
      });
    }

    // Populate pembayaran table
    function populatePembayaranTable() {
      const pembayaranList = loadFromLS(LS_PEMBAYARAN);
      pembayaranTableBody.innerHTML = "";
      pembayaranList.forEach((pembayaran, i) => {
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i + 1}</td>
          <td class="border border-green-300 px-4 py-2">${pembayaran.nama}</td>
          <td class="border border-green-300 px-4 py-2">${pembayaran.jumlah.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2 capitalize">${pembayaran.metode}</td>
          <td class="border border-green-300 px-4 py-2">${new Date(pembayaran.tanggal).toLocaleDateString("id-ID")}</td>
        `;
        pembayaranTableBody.appendChild(tr);
      });
    }

    // Populate laporan penjualan
    function populateLaporanPenjualan() {
      const transaksiList = loadFromLS(LS_TRANSAKSI);
      const produkList = loadFromLS(LS_PRODUK);
      const laporanMap = new Map();

      transaksiList.forEach((transaksi) => {
        if (!laporanMap.has(transaksi.produkId)) {
          laporanMap.set(transaksi.produkId, { jumlah: 0, total: 0 });
        }
        const produk = produkList.find((p) => p.id === transaksi.produkId);
        if (produk) {
          const data = laporanMap.get(transaksi.produkId);
          data.jumlah += transaksi.jumlah;
          data.total += transaksi.jumlah * produk.harga;
          laporanMap.set(transaksi.produkId, data);
        }
      });

      laporanPenjualanBody.innerHTML = "";
      let i = 1;
      laporanMap.forEach((data, produkId) => {
        const produk = produkList.find((p) => p.id === produkId);
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i++}</td>
          <td class="border border-green-300 px-4 py-2">${produk ? produk.nama : "Produk tidak ditemukan"}</td>
          <td class="border border-green-300 px-4 py-2">${data.jumlah}</td>
          <td class="border border-green-300 px-4 py-2">${data.total.toLocaleString("id-ID")}</td>
        `;
        laporanPenjualanBody.appendChild(tr);
      });
      if (laporanMap.size === 0) {
        laporanPenjualanBody.innerHTML = `<tr><td colspan="4" class="text-center py-6 text-green-400 font-semibold">Belum ada data penjualan</td></tr>`;
      }
    }

    // Populate laporan kasbon
    function populateLaporanKasbon() {
      const kasbonList = loadFromLS(LS_KASBON);
      const pembayaranList = loadFromLS(LS_PEMBAYARAN);
      const laporanMap = new Map();

      kasbonList.forEach((kasbon) => {
        if (!laporanMap.has(kasbon.nama)) {
          laporanMap.set(kasbon.nama, { kasbon: 0, pembayaran: 0 });
        }
        const data = laporanMap.get(kasbon.nama);
        data.kasbon += kasbon.jumlah;
        laporanMap.set(kasbon.nama, data);
      });

      pembayaranList.forEach((pembayaran) => {
        if (!laporanMap.has(pembayaran.nama)) {
          laporanMap.set(pembayaran.nama, { kasbon: 0, pembayaran: 0 });
        }
        const data = laporanMap.get(pembayaran.nama);
        data.pembayaran += pembayaran.jumlah;
        laporanMap.set(pembayaran.nama, data);
      });

      laporanKasbonBody.innerHTML = "";
      let i = 1;
      laporanMap.forEach((data, nama) => {
        const sisa = data.kasbon - data.pembayaran;
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i++}</td>
          <td class="border border-green-300 px-4 py-2">${nama}</td>
          <td class="border border-green-300 px-4 py-2">${data.kasbon.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${data.pembayaran.toLocaleString("id-ID")}</td>
          <td class="border border-green-300 px-4 py-2">${sisa.toLocaleString("id-ID")}</td>
        `;
        laporanKasbonBody.appendChild(tr);
      });
      if (laporanMap.size === 0) {
        laporanKasbonBody.innerHTML = `<tr><td colspan="5" class="text-center py-6 text-green-400 font-semibold">Belum ada data kasbon dan pembayaran</td></tr>`;
      }
    }

    // Authentication handlers
    authForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const role = roleSelect.value.trim();
      const username = usernameInput.value.trim();
      const password = passwordInput.value.trim();

      if (!role || !username || !password) {
        alert("Semua field harus diisi.");
        return;
      }

      let users = loadFromLS(LS_USERS);

      if (isSignIn) {
        // Sign In
        const user = users.find(
          (u) => u.username === username && u.password === password && u.role === role
        );
        if (user) {
          currentUser = user;
          afterLogin();
        } else {
          alert("Username, password, atau role salah.");
        }
      } else {
        // Sign Up
        const exists = users.some((u) => u.username === username);
        if (exists) {
          alert("Username sudah digunakan.");
          return;
        }
        const newUser = {
          id: users.length ? users[users.length - 1].id + 1 : 1,
          username,
          password,
          role,
        };
        users.push(newUser);
        saveToLS(LS_USERS, users);
        alert("Registrasi berhasil. Silakan sign in.");
        toggleAuth();
      }
    });

    toggleAuthBtn.addEventListener("click", () => {
      toggleAuth();
    });

    btnSignIn.addEventListener("click", () => {
      if (!isSignIn) toggleAuth();
      authSection.scrollIntoView({ behavior: "smooth" });
    });

    btnSignUp.addEventListener("click", () => {
      if (isSignIn) toggleAuth();
      authSection.scrollIntoView({ behavior: "smooth" });
    });

    btnLogout.addEventListener("click", () => {
      if (confirm("Apakah Anda yakin ingin logout?")) {
        currentUser = null;
        dashboardSection.classList.add("hidden");
        authSection.classList.remove("hidden");
        authForm.reset();
        showDashboardSection("produkSection");
        sessionStorage.removeItem("tptm_currentUser");
      }
    });

    // After login setup
    function afterLogin() {
      authSection.classList.add("hidden");
      dashboardSection.classList.remove("hidden");
      transaksiKasir.value = currentUser.username;
      showDashboardSection("produkSection");
      populateProdukSelects();
      populateTransaksiTable();
      populateKasbonTable();
      populatePembayaranTable();
      populateLaporanPenjualan();
      populateLaporanKasbon();
      sessionStorage.setItem("tptm_currentUser", JSON.stringify(currentUser));
    }

    // Sidebar navigation
    sidebarButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        showDashboardSection(btn.dataset.section);
      });
    });

    // Produk form submit (add/update)
    produkForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const nama = produkNama.value.trim();
      const harga = parseInt(produkHarga.value);
      const stok = parseInt(produkStok.value);

      if (!nama || isNaN(harga) || isNaN(stok) || harga < 0 || stok < 0) {
        alert("Mohon isi data produk dengan benar.");
        return;
      }

      let produkList = loadFromLS(LS_PRODUK);
      // Check if product with same name exists (case insensitive)
      const existingIndex = produkList.findIndex(
        (p) => p.nama.toLowerCase() === nama.toLowerCase()
      );

      if (existingIndex >= 0) {
        // Update existing product
        produkList[existingIndex].harga = harga;
        produkList[existingIndex].stok = stok;
      } else {
        // Add new product
        const newProduk = {
          id: produkList.length ? produkList[produkList.length - 1].id + 1 : 1,
          nama,
          harga,
          stok,
        };
        produkList.push(newProduk);
      }
      saveToLS(LS_PRODUK, produkList);
      produkForm.reset();
      populateProdukSelects();
      populateTransaksiTable();
      populateLaporanPenjualan();
      alert("Data produk berhasil disimpan.");
    });

    // Produk edit and delete buttons
    produkTableBody.addEventListener("click", (e) => {
      if (e.target.closest(".produk-edit-btn")) {
        const id = parseInt(e.target.closest(".produk-edit-btn").dataset.id);
        let produkList = loadFromLS(LS_PRODUK);
        const produk = produkList.find((p) => p.id === id);
        if (produk) {
          produkNama.value = produk.nama;
          produkHarga.value = produk.harga;
          produkStok.value = produk.stok;
          window.scrollTo({ top: 0, behavior: "smooth" });
        }
      } else if (e.target.closest(".produk-delete-btn")) {
        const id = parseInt(e.target.closest(".produk-delete-btn").dataset.id);
        if (confirm("Apakah Anda yakin ingin menghapus produk ini?")) {
          let produkList = loadFromLS(LS_PRODUK);
          produkList = produkList.filter((p) => p.id !== id);
          saveToLS(LS_PRODUK, produkList);
          populateProdukSelects();
          populateTransaksiTable();
          populateLaporanPenjualan();
          alert("Produk berhasil dihapus.");
        }
      }
    });

    // Transaksi form submit
    transaksiForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const produkId = parseInt(transaksiProduk.value);
      const jumlah = parseInt(transaksiJumlah.value);
      const kasir = transaksiKasir.value;

      if (isNaN(produkId) || isNaN(jumlah) || jumlah < 1) {
        alert("Mohon pilih produk dan masukkan jumlah yang valid.");
        return;
      }

      let produkList = loadFromLS(LS_PRODUK);
      const produk = produkList.find((p) => p.id === produkId);
      if (!produk) {
        alert("Produk tidak ditemukan.");
        return;
      }
      if (produk.stok < jumlah) {
        alert("Stok produk tidak cukup.");
        return;
      }

      // Kurangi stok produk
      produk.stok -= jumlah;
      saveToLS(LS_PRODUK, produkList);

      // Tambah transaksi
      let transaksiList = loadFromLS(LS_TRANSAKSI);
      transaksiList.push({
        id: transaksiList.length ? transaksiList[transaksiList.length - 1].id + 1 : 1,
        produkId,
        jumlah,
        kasir,
        tanggal: new Date().toISOString(),
      });
      saveToLS(LS_TRANSAKSI, transaksiList);

      transaksiForm.reset();
      transaksiKasir.value = kasir;
      populateProdukSelects();
      populateTransaksiTable();
      populateLaporanPenjualan();
      populateStokTable();
      alert("Transaksi berhasil ditambahkan.");
    });

    // Stok form submit
    stokForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const produkId = parseInt(stokProduk.value);
      const jumlah = parseInt(stokJumlah.value);

      if (isNaN(produkId) || isNaN(jumlah)) {
        alert("Mohon pilih produk dan masukkan jumlah yang valid.");
        return;
      }

      let produkList = loadFromLS(LS_PRODUK);
      const produk = produkList.find((p) => p.id === produkId);
      if (!produk) {
        alert("Produk tidak ditemukan.");
        return;
      }

      const newStok = produk.stok + jumlah;
      if (newStok < 0) {
        alert("Stok tidak boleh kurang dari 0.");
        return;
      }
      produk.stok = newStok;
      saveToLS(LS_PRODUK, produkList);
      stokForm.reset();
      populateProdukSelects();
      populateStokTable();
      alert("Stok berhasil diperbarui.");
    });

    // Populate stok table (for update stok section)
    function populateStokTable() {
      const produkList = loadFromLS(LS_PRODUK);
      stokTableBody.innerHTML = "";
      produkList.forEach((produk, i) => {
        const tr = document.createElement("tr");
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
          <td class="border border-green-300 px-4 py-2">${i + 1}</td>
          <td class="border border-green-300 px-4 py-2">${produk.nama}</td>
          <td class="border border-green-300 px-4 py-2">${produk.stok}</td>
        `;
        stokTableBody.appendChild(tr);
      });
    }

    // Kasbon form submit
    kasbonForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const nama = kasbonNama.value.trim();
      const jumlah = parseInt(kasbonJumlah.value);
      const tanggal = kasbonTanggal.value;

      if (!nama || isNaN(jumlah) || jumlah < 0 || !tanggal) {
        alert("Mohon isi data kasbon dengan benar.");
        return;
      }

      let kasbonList = loadFromLS(LS_KASBON);
      kasbonList.push({
        id: kasbonList.length ? kasbonList[kasbonList.length - 1].id + 1 : 1,
        nama,
        jumlah,
        tanggal,
        status: "Belum Lunas",
      });
      saveToLS(LS_KASBON, kasbonList);
      kasbonForm.reset();
      populateKasbonTable();
      populateLaporanKasbon();
      alert("Kasbon berhasil ditambahkan.");
    });

    // Pembayaran form submit
    pembayaranForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const nama = pembayaranNama.value.trim();
      const jumlah = parseInt(pembayaranJumlah.value);
      const metode = pembayaranMetode.value;
      const tanggal = pembayaranTanggal.value;

      if (!nama || isNaN(jumlah) || jumlah < 0 || !metode || !tanggal) {
        alert("Mohon isi data pembayaran dengan benar.");
        return;
      }

      let pembayaranList = loadFromLS(LS_PEMBAYARAN);
      pembayaranList.push({
        id: pembayaranList.length ? pembayaranList[pembayaranList.length - 1].id + 1 : 1,
        nama,
        jumlah,
        metode,
        tanggal,
      });
      saveToLS(LS_PEMBAYARAN, pembayaranList);
      pembayaranForm.reset();
      populatePembayaranTable();
      populateLaporanKasbon();
      alert("Pembayaran berhasil ditambahkan.");
    });

    // On page load
    window.addEventListener("load", () => {
      initDefaultUsers();
      initDefaultProduk();
      // If user is logged in (sessionStorage)
      const savedUser = sessionStorage.getItem("tptm_currentUser");
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        afterLogin();
      }
    });
  </script>
 </body>
</html>